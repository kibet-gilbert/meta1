Bootstrap: docker
From: continuumio/miniconda3

%files
    meta1_env.yml

%post
    #git clone https://github.com/artic-network/fieldbioinformatics
    #cd fieldbioinformatics && python setup.py install
    #conda install mamba
    /opt/conda/bin/conda env create -f meta1_env.yml
    NOW=`date`
    meta1version=${NOW}V_meta1
    echo "export NOW=\"${NOW}\"" >> $APPTAINER_ENVIRONMENT

%environment
    export PATH=/opt/conda/bin:$PATH
    export PATH=/opt/conda/envs/meta1/bin:$PATH
    export $meta1version

%runscript
    echo "Created on $NOW"
    exec $*

%test
    fastp -v
    fastqc -h
    kraken2 -h
    ktUpdateTaxonomy.sh -h

%labels
    Author kibet-gilbert
    Version $meta1version

%help
    Singularity container for shotgun metagenomics meta1
    Apps available:
    fastp		Display basecallers in files
    fastqc		Run demultiplex
    kraken2		Run the alignment/variant-call/consensus pipeline
    ktImportTaxonomy	Gather up demultiplexed files
    spades.py		Assembly of the genomes
    metaspades.py	Assembly pf metagenomes (Same as: spades.py --meta)
    checkm2		Predict the completeness and contamination of genome bins
    run_MaxBin
    metabat2
    
